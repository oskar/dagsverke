<html>
<head>
<style>
h1, p, input, #work_time { font-size: 2em; font-family: Verdana; }
#lunch { width: 2em; }
#work_time { width: 10em; }
#content { width: 350px; margin-left: auto; margin-right: auto; }
h1 { font-size: 3em; text-align: center; }
</style>
<script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<title>Dagsverke</title>
</head>
<body>
<div id="content">
  <h1>Dagsverke</h1>
  <table>
    <tr>
      <td><p>Kom</p></td>
      <td class="middle-column">&nbsp;</td>
      <td><input type="time" id="start_time" /></td>
    </tr>
    <tr>
      <td><p>Gick</p></td>
      <td class="middle-column">&nbsp;</td>
      <td><input type="time" id="end_time" /></td>
    </tr>
    <tr>
      <td><p>Lunch</p></td>
      <td class="middle-column">&nbsp;</td>
      <td><input type="text" id="lunch" value="60"/></td>
    </tr>
    <tr>
      <td colspan="3"><p>&nbsp;</p></td>
    </tr>
    <tr>
      <td><p>Arbetstid</p></td>
      <td class="middle-column">&nbsp;</td>
      <td><input type="text" disabled id="work_time"></div></td>
    </tr>
  </table>
</div>

<script>
function parse() {
  var start = $('#start_time').val();
  var end = $('#end_time').val();
  var lunch = $('#lunch').val();
  
  var startInMinutes = toMinutes(start);
  var endInMinutes = toMinutes(end);
  
  var workInMinutes = endInMinutes - startInMinutes - lunch;
  
  if(isNaN(workInMinutes))
    return;
  
  var workTime = Math.round(workInMinutes * 100 / 60) / 100;
  var workHours = Math.floor(workInMinutes / 60);
  var workMinutes = workInMinutes % 60;
  
  $('#work_time').val(workHours + 'h ' + workMinutes + 'min (' + workTime + ')');
}

function toMinutes(str) {
  var arr = str.split(':');
  return parseInt(arr[0], 10) * 60 + parseInt(arr[1], 10);
}

$('#start_time').change(parse);
$('#end_time').change(parse);
$('#lunch').change(parse);
</script>
</body>
</html>
